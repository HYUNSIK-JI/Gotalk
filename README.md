# 프로젝트: Gotalk

## 1. 요구 사항

1) 실시간 채팅이 가능 할것
2) 채팅 내용이 db에 저장 될 것
3) 익명일때도 이전 채팅 내역을 볼 수 있을 것 (부가적인 사항)
4) 차단한 자의 메시지는 볼 수 없다.
5) 메세지 삭제 기능 -> 전체 채팅 삭제 or 나에게만 삭제
6) 대용량 데이터 처리
## 2. 프로젝트 목적

1) 앱으로도 전환 (플레이스토어 등록)
2) Redis, 웹 소켓, 통신, 도커, 클래스 등 학습

## 3. 사용 기술

1) 우선 DJango template 으로 진행 -> 리액트 와 연동
2) Docker
3) Django
4) WebSocket
5) MySQL
6) Redis

## 4. ERD


## 5. 개발 이슈
1. nginx 설정 이후 socket 연결 끊김 (2023-03-21) -> 원인 : CORS, 문제 해결: nginx 설정 CORS 설정 추가
2. redis 기본 설정 중 bind 부분이 배포 중인 주소와 일치 하지 않아 채팅 불가 현상 -> redis 설정 파일 중 bind default 값 변경 -> 127.0.0.1 -> 0.0.0.0 ::1
3. 채팅 중 상대방 채팅 과 나의 채팅을 구별이 필요 했다 -> 원인: 비교 대상이 정확하지 않아 구별 하지 못했다. 문제 해결:views.py 통해 html로 전달 되는 데이터중
   request.user을 통해 username 전달, 웹 소켓을 채팅을 전송 할때 전달 받은 usernanme을 같이 전달 전달 받은 두개의 값을 비교 하여 css을 다르게 주어 
   위치상으로 채팅 구별 완료
   
4. 채팅 내용 Redis의 캐시메모리로 저장 중 Prefix must be unicode 오류 발견 이 오류를 배제 하고 진행 시 메시지의 내용이 언코딩 되지 않는 현상 발생
5.
6.

## 6.구조도
![image](https://user-images.githubusercontent.com/59475851/226532602-435d4077-d8f0-4a77-965a-23c561fc77e3.png)


## 7. 진행상황
2023-03-25: 간단한 회원가입, 로그인 구축 및 채팅방 입장, 퇴장시 유저 네임 출력

2023-03-26: 메시지 보낸이 출력

2023-03-30: 메시지 보낸이 상대방 과 나 구별 완료

2023-03-31: 차단한 자의 채팅 메시지는 보이지 않도록 설정

2023-04-03: 상대방 디테일 페이지에서 채팅 보내기 기능 구현 및 캐시 메모리로 메시지 저장 하여 이전 기록들을 볼수 있도록 구현 중
## 8. 배포
AWS ec2에 도커를 활용 하여 https://www.gotalk.shop 으로 진행 예정 -> 도메인 구매 완료
